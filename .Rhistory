source("0_functions/function_gmin.R")
source("0_functions/function_gmin_routine.R")
### load data
db = read.table("1_data/Gmin_C_distishoclata_27_abr_2024.csv",
h=T,
sep= ";",
dec = ","
)
### processing common info
db$atm = mean(db[["Atmospheric_pressure"]], na.rm = T)
## sp name
sp = unique(db$Specie)
individuals = unique(db$Individual)
### loop
for(id in individuals){
## filter by id
my_data = db %>%
filter(Individual == id)
## how many leaves?
leaves = unique(my_data$Leaf)
for(leaf in leaves){
## filter by leaf
my_data = my_data %>%
filter(Leaf == leaf) %>%
mutate(area = mean(`Area.moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data, file_name =  file_name)
}
}
View(my_data)
id
leaf
### libraries
if (!require("tidyverse")) install.packages("tidyverse"); require("tidyverse")
if (!require("ggplot2")) install.packages("ggplot2"); library("ggplot2")
if (!require("ggpubr")) install.packages("ggpubr"); library("ggpubr")
### my functions
source("0_functions/function_vpsat.R")
source("0_functions/function_mfvpd.R")
source("0_functions/function_delta.R")
source("0_functions/function_gmin.R")
source("0_functions/function_gmin_routine.R")
### load data
db = read.table("1_data/Gmin_C_distishoclata_27_abr_2024.csv",
h=T,
sep= ";",
dec = ","
)
### processing common info
db$atm = mean(db[["Atmospheric_pressure"]], na.rm = T)
## sp name
sp = unique(db$Specie)
individuals = unique(db$Individual)
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(Individual == id)
## how many leaves?
leaves = unique(my_data$Leaf)
for(leaf in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(Leaf == leaf) %>%
mutate(area = mean(`Area.moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(Individual == id)
## how many leaves?
leaves = unique(my_data1$Leaf)
for(leaf in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(Leaf == leaf) %>%
mutate(area = mean(`Area.moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
### libraries
if (!require("tidyverse")) install.packages("tidyverse"); require("tidyverse")
if (!require("ggplot2")) install.packages("ggplot2"); library("ggplot2")
if (!require("ggpubr")) install.packages("ggpubr"); library("ggpubr")
### my functions
source("0_functions/function_vpsat.R")
source("0_functions/function_mfvpd.R")
source("0_functions/function_delta.R")
source("0_functions/function_gmin.R")
source("0_functions/function_gmin_routine.R")
### load data
db = read.table("1_data/Gmin_C_nictitans_24_mar_2024.csv",
h=T,
sep= ";",
dec = ","
)
### processing common info
db$atm = mean(db[["atmospheric_pressure"]], na.rm = T)
db
## sp name
sp = unique(db$specie)
individuals = unique(db$individual)
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(Individual == id)
## how many leaves?
leaves = unique(my_data1$Leaf)
for(leaf in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(Leaf == leaf) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$Leaf)
for(leaf in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
file_name
sp
id
leaf
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$leaf)
for(leaf in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
data = my_data2
### major parameters
t = data[["time_minutes"]]
w =  data[["weight_g"]]
temp = data[["temp_C"]]
humid = data[["humid_perc"]]
area = data[["area"]]
atm = data[["atm"]]
### calcularte vpsat
vpsat_val = vpsat(temp = temp)
### calculate mfvpd
mfvpd_val = mfvpd(humid = humid,
vpsat = vpsat_val,
atm = atm
)
### calculate delta weight and time
dw_val = delta(x = w)
dt_val = delta(x = t)
### calculate gmin
gmin_val = gmin(dw = dw_val,
dt = dt_val,
mfvpd = mfvpd_val[-1],
area = area[-1] )
### gmin mean
gmin_mean = mean(gmin_val)
### result table
resul_table = cbind(t,vpsat_val, mfvpd_val, c(0,gmin_val), gmin_mean )
colnames(resul_table) = c("time", "vpsat", "mfvpd" ,"gmin", "gmin_mean")
### linear model
lm_fit = lm(w ~ t)
lm_test = summary(lm_fit)
intercept = lm_test$coefficients[[1]]
slope = lm_test$coefficients[[2]]
intercept
slope
### annotations
r2_txt = round(lm_test$adj.r.squared, 5)
r2_txt
round(intercept, 3)
intercept_txt = round(intercept, 3)
if(slope > 0){
slope_txt = paste0("+",round (slope, 3) )
}else{
slope_txt = round(slope, 3)
}
lm_formula = paste0("y = ", intercept_txt, slope_txt,"x" )
lm_formula
intercept_txt
paste0("y = ", intercept_txt, slope_txt,"x" )
intercept_txt
intercept_txt
paste0("y = ", intercept_txt, slope_txt,"x" )
paste("y = ", intercept_txt, slope_txt,"x", sep="" )
intercept_txt
slope_txt
slope
paste0("+",round (slope, 3) )
paste0("+",round (slope, 5) )
### annotations
r2_txt = round(lm_test$adj.r.squared, 5)
intercept_txt = round(intercept, 3)
if(slope > 0){
slope_txt = paste0("+",slope)
}else{
slope_txt = slope
}
lm_formula = paste("y = ", intercept_txt, slope_txt,"x", sep="" )
### annotations
r2_txt = round(lm_test$adj.r.squared, 5)
intercept_txt = round(intercept, 3)
if(slope > 0){
slope_txt = paste0("+",slope)
}else{
slope_txt = slope
}
lm_formula = paste0("y = ", intercept_txt, slope_txt,"x")
lm_formula
lm_test
source("0_functions/function_gmin_routine.R")
### load data
db = read.table("1_data/Gmin_C_nictitans_24_mar_2024.csv",
h=T,
sep= ";",
dec = ","
)
### libraries
if (!require("tidyverse")) install.packages("tidyverse"); require("tidyverse")
if (!require("ggplot2")) install.packages("ggplot2"); library("ggplot2")
if (!require("ggpubr")) install.packages("ggpubr"); library("ggpubr")
### my functions
source("0_functions/function_vpsat.R")
source("0_functions/function_mfvpd.R")
source("0_functions/function_delta.R")
source("0_functions/function_gmin.R")
source("0_functions/function_gmin_routine.R")
### load data
db = read.table("1_data/Gmin_C_nictitans_24_mar_2024.csv",
h=T,
sep= ";",
dec = ","
)
### processing common info
db$atm = mean(db[["atmospheric_pressure"]], na.rm = T)
## sp name
sp = unique(db$specie)
individuals = unique(db$individual)
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$leaf)
for(leaf in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
### libraries
if (!require("tidyverse")) install.packages("tidyverse"); require("tidyverse")
if (!require("ggplot2")) install.packages("ggplot2"); library("ggplot2")
if (!require("ggpubr")) install.packages("ggpubr"); library("ggpubr")
### my functions
source("0_functions/function_vpsat.R")
source("0_functions/function_mfvpd.R")
source("0_functions/function_delta.R")
source("0_functions/function_gmin.R")
source("0_functions/function_gmin_routine.R")
### load data
db = read.table("1_data/Gmin_C_nictitans_24_mar_2024.csv",
h=T,
sep= ";",
dec = ","
)
### processing common info
db$atm = mean(db[["atmospheric_pressure"]], na.rm = T)
## sp name
sp = unique(db$specie)
individuals = unique(db$individual)
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$leaf)
for(leaf in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
### load data
db = read.table("1_data/Gmin_C_distishoclata_27_abr_2024.csv",
h=T,
sep= ";",
dec = ","
)
### processing common info
db$atm = mean(db[["atmospheric_pressure"]], na.rm = T)
## sp name
sp = unique(db$specie)
individuals = unique(db$individual)
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$leaf)
for(leaf in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
View(db)
### load data
db = read.table("1_data/Gmin_C_distishoclata_27_abr_2024.csv",
h=T,
sep= ";",
dec = ","
)
### processing common info
db$atm = mean(db[["atmospheric_pressure"]], na.rm = T)
## sp name
sp = unique(db$specie)
individuals = unique(db$individual)
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$leaf)
for(leaf in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
### load data
db = read.table("1_data/Gmin_C_distishoclata_27_abr_2024.csv",
h=T,
sep= ";",
dec = ","
)
View(db)
### processing common info
db$atm = mean(db[["atmospheric_pressure"]], na.rm = T)
## sp name
sp = unique(db$specie)
individuals = unique(db$individual)
id
## sp name
sp = unique(db$specie)
individuals = unique(db$individual)
individuals
id
id = 1
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$leaf)
my_data1
leaves
leaf = 1
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
my_data2
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf_num) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
leaf_num = 1
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf_num) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
my_data2
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$leaf)
for(leaf_num in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf_num) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
id = 1
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$leaf)
leaf_num = 3
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf_num) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
my_data2
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$leaf)
for(leaf_num in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf_num) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf_num, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
### load data
db = read.table("1_data/Gmin_C_brachystachia_01_mai_2024.csv",
h=T,
sep= ";",
dec = ","
)
### processing common info
db$atm = mean(db[["atmospheric_pressure"]], na.rm = T)
## sp name
sp = unique(db$specie)
individuals = unique(db$individual)
### loop
for(id in individuals){
## filter by id
my_data1 = db %>%
filter(individual == id)
## how many leaves?
leaves = unique(my_data1$leaf)
for(leaf_num in leaves){
## filter by leaf
my_data2 = my_data1 %>%
filter(leaf == leaf_num) %>%
mutate(area = mean(`area_moist_cm2`, na.rm = T))
## set name
file_name = paste(sp,id,leaf_num, sep="_")
## gmin analyses
gmin_routine(data = my_data2, file_name =  file_name)
}
}
